Option ExplicitDim oldtool As IntegerDim newtool As IntegerDim tcatcp As IntegerDim tcatlo As IntegerDim tloptl As IntegerDim skiprh As IntegerDim NRH As Integer'getting initial valuesskiprh = getoemled(1726)tloptl = getoemled(1764)tcatlo = getoemled(1711)tcatcp = getoemled(1709)'looking for RH/NRH tool setting - 0 if RH toolNRH = InStr(1, GetToolDesc(GetSelectedTool()), "NRH")message "M606 Start"oldtool = Getoemdro (1824) 		newtool = GetSelectedTool()		If newtool <> oldtool And newtool > 0 Then 	If NRH = 0 And skiprh <> 0 Then Call RunScript("ScreenSetMacros\" & GetActiveScreenSetName() & "\" & "Masters\Scripts\Common\RHTHolders")	sleep 50	If NRH = 0 And tloptl <> 0 Then Call RunScript("ScreenSetMacros\" & GetActiveScreenSetName() & "\" & "Masters\Scripts\Common\TCAutoTLOFromPTL")	sleep 50	If NRH = 0 And tcatlo <> 0 Then Call RunScript("ScreenSetMacros\" & GetActiveScreenSetName() & "\" & "Masters\Scripts\Common\TCAutoTLO")	sleep 50	If NRH = 0 And tcatcp <> 0 Then Call RunScript("ScreenSetMacros\" & GetActiveScreenSetName() & "\" & "Masters\Scripts\Common\TCAutoTCP")	sleep 50		message "M6ATC Start" 	code "M6T" & newtool	sleep 1000		'wait for M6ATC to finish		While getoemled(1725) <> 0		sleep 250		Wend		message "M6ATC Ended" 		'restoring initial settings		If tcatcp <> 0 And getoemled(1709) = 0 Then Call RunScript("ScreenSetMacros\" & GetActiveScreenSetName() & "\" & "Masters\Scripts\Common\TCAutoTCP")	sleep 50	If tcatlo <> 0 And getoemled(1711) = 0 Then Call RunScript("ScreenSetMacros\" & GetActiveScreenSetName() & "\" & "Masters\Scripts\Common\TCAutoTLO")	sleep 50	If tloptl <> 0 And getoemled(1764) = 0 Then Call RunScript("ScreenSetMacros\" & GetActiveScreenSetName() & "\" & "Masters\Scripts\Common\TCAutoTLOFromPTL")	sleep 50	If skiprh <> 0 And getoemled(1726) = 0 Then Call RunScript("ScreenSetMacros\" & GetActiveScreenSetName() & "\" & "Masters\Scripts\Common\RHTHolders")	sleep 50	End Ifmessage "M606 End"		              