'********DO NOT remove or change the expand line or the included file contents******************'  MachStdMIll license terms REQUIRE that the copyright and License terms remain a part of this source file#expand <Masters\Headers\CopyRightAndLicenseNotice>	'**************************************************************************************Sub MSMPageChange(ByVal ThisPageNum As Integer)	' this code handles going to a page 	' it tracks the last page and the last tab for tabbed page sets.		Dim LastTab As Integer		' find out which page we are going to...	Select Case ThisPageNum		Case MSMWCOffsetTabGroup			' going to the last selected page of the WC Offset tab group			LastTab = GetUserDRO(MSMLastWCTabPageDRO)			' **ALL** the WC Tab sub pages need to be in this conditional...			If LastTab <> MSMOffsetTouchPage And _				LastTAb <> MSMOffsetProbePage And _				LastTAb <> MSMOffsetProbePage2 And _				LastTAb <> MSMOffsetProbePage3 And _				LastTAb <> MSMOffsetProbePage4 And _				LastTAb <> MSMOffsetProbePage5 And _				LastTAb <> MSMOffsetProbePage6 Then				' tabs got out of sync somehow				' reset the last tab var to the main group page				SetUserDRO(MSMLastWCTabPageDRO, MSMOffsetTouchPage)    				LastTab = MSMOffsetTouchPage			End If			SetUserDRO(MSMLastScreenPageDRO, LastTab)			DoOEMBUtton(LastTab)		Case MSMOffsetTouchPage			' going to a specific tab of the WC Offset tab group			SetUserDRO(MSMLastWCTabPageDRO, ThisPageNum)			SetUserDRO(MSMLastScreenPageDRO, ThisPageNum)			DoOEMBUtton(ThisPageNum)				Case MSMWCOffsetTabProbeGroup			' going to the last selected page of the WC Offset tab group			LastTab = GetUserDRO(MSMLastWCTabProbePageDRO)			' **ALL** the probing sub pages need to be in this conditional			If LastTAb <> MSMOffsetProbePage And _			   LastTAb <> MSMOffsetProbePage2 And _			   LastTAb <> MSMOffsetProbePage3 And _			   LastTAb <> MSMOffsetProbePage4 And _			   LastTAb <> MSMOffsetProbePage5 And _			   LastTAb <> MSMOffsetProbePage6 Then				' tabs got out of sync somehow				' reset the last tab var to the main group page				SetUserDRO(MSMLastWCTabProbePageDRO, MSMOffsetProbePage)    				LastTab = MSMOffsetProbePage			End If			SetUserDRO(MSMLastWCTabPageDRO, LastTab)			'SetUserDRO(MSMLastWCTabProbePageDRO, LastTab)			SetUserDRO(MSMLastScreenPageDRO, LastTab)			DoOEMBUtton(LastTab)		Case MSMOffsetProbePage, MSMOffsetProbePage2, MSMOffsetProbePage3, MSMOffsetProbePage4, MSMOffsetProbePage5, MSMOffsetProbePage6		' **ALL** the probing pages need to be in this case 			' going to a specific Subtab of the WC Offset Probing group			SetUserDRO(MSMLastWCTabPageDRO, ThisPageNum)			SetUserDRO(MSMLastWCTabProbePageDRO, ThisPageNum)			SetUserDRO(MSMLastScreenPageDRO, ThisPageNum)			DoOEMBUtton(ThisPageNum)						Case MSMWRunTabGroup			' going to the last selected page of the Run tab group			LastTab = GetUserDRO(MSMLastRunTabPageDRO)			If LastTab <> MSMRunPage And LastTab <> MSMRunBigPage Then				' tabs got out of sync somehow				' reset the last tab var to the main group page				SetUserDRO(MSMLastRunTabPageDRO, MSMRunPage)			End If			SetUserDRO(MSMLastScreenPageDRO, LastTab)			DoOEMBUtton(LastTab)		Case MSMRunPage, MSMRunBigPage			' going to a specific tab of the Run tab group			SetUserDRO(MSMLastRunTabPageDRO, ThisPageNum)			SetUserDRO(MSMLastScreenPageDRO, ThisPageNum)			DoOEMBUtton(ThisPageNum)				Case MSMSettingsTabGroup			' going to a page that is part of the Settings tab group			LastTab = GetUserDRO(MSMLastSettingsTabPageDRO)			If LastTab <> MSMSettingsCommonPage And LastTab <> MSMSettingsSpindlePage Then				' tabs got out of sync somehow				' reset the last tab var to the main group page				SetUserDRO(MSMLastSettingsTabPageDRO, MSMSettingsCommonPage)			End If			SetUserDRO(MSMLastScreenPageDRO, LastTab)			DoOEMBUtton(LastTab)		Case MSMSettingsCommonPage, MSMSettingsSpindlePage			' going to a specific tab of the Settings tab group			SetUserDRO(MSMLastSettingsTabPageDRO, ThisPageNum)			SetUserDRO(MSMLastScreenPageDRO, ThisPageNum)			DoOEMBUtton(ThisPageNum)				Case MSMHardwareTabGroup			' going to a page that is part of the hardware tab group			LastTab = GetUserDRO(MSMLastHardwareTabPageDRO)			If LastTab <> MSMHardwareSignalsPage And _			   LastTab <> MSMHardwarePPPage and _			   LastTab <> MSMHardwarePPPage2Out Then				' tabs got out of sync somehow				' reset the last tab var to the main group page				SetUserDRO(MSMLastHardwareTabPageDRO, MSMHardwareSignalsPage)			End If			SetUserDRO(MSMLastScreenPageDRO, LastTab)			DoOEMBUtton(LastTab)		Case MSMHardwareSignalsPage, MSMHardwarePPPage, MSMHardwarePPPage2Out			' going to a specific tab of the Hardware tab group			SetUserDRO(MSMLastHardwareTabPageDRO, ThisPageNum)			SetUserDRO(MSMLastScreenPageDRO, ThisPageNum)			DoOEMBUtton(ThisPageNum)				Case Else			' we are going to a regular, non-tab group page			SetUserDRO(MSMLastScreenPageDRO, ThisPageNum)			DoOEMBUtton(ThisPageNum)	End SelectEnd Sub	' MSMpageChange