Option Explicit'********DO NOT remove or change the expand line or the included file contents******************'  MachStdMIll license terms REQUIRE that the copyright and License terms remain a part of this source file#expand <Masters\Headers\CopyRightAndLicenseNotice>	'**************************************************************************************' MSM did not touch this code,  it is the "classic" mach V3 code for this button, used by permission of ArtSoft USA.'( except to add option explicit and declare the variables)Sub Main()	Begin Dialog GroupSample 31,32,120,96,"Axis Selection"		OKButton 38,75,40,14		GroupBox 12,8,96,62,"Pick Axis to Calibrate",.GroupBox1		OptionGroup .OptionGroup1		OptionButton 20,24,40,8,"X Axis",.OptionButton1		OptionButton 20,40,40,8,"Y Axis",.OptionButton2		OptionButton 20,56,40,8,"Z Axis",.OptionButton3		OptionButton 67,24,40,8,"A Axis",.OptionButton4		OptionButton 67,40,40,8,"B Axis",.OptionButton5		OptionButton 67,56,40,8,"C Axis",.OptionButton6	End Dialog	Dim Dlg1 As GroupSample	Dim Button As Integer	Dim AxisNum As Integer	Dim Axis As String	Dim AxisLetter As String	Dim ComMove As Double	Dim ActMOve As Double	Dim OldPPR As Double	Dim NewPPR As Double	Dim response As Integer			Button = Dialog (Dlg1)	If Button = 0 Then		Exit Sub	End If		AxisNum = Dlg1.OptionGroup1	Select Case AxisNum	Case 0 		Axis = "StepsPerAxisX"		AxisLetter = "X"	Case 1 		Axis = "StepsPerAxisY"		AxisLetter =" Y"	Case 2 		Axis = "StepsPerAxisZ"		AxisLetter = "Z"	Case 3 		Axis = "StepsPerAxisA"		AxisLetter = "A"	Case 4 		Axis = "StepsPerAxisB"		AxisLetter = "B"	Case 5 		Axis = "StepsPerAxisC"		AxisLetter = "C"	End Select	ComMove = Question ("How far would you like to Move the " & AxisLetter & " Axis?")	If COMMove = 0 Then		MsgBox "Can't have a Move of Zero, Axis Calc aborted."		Exit Sub	End If		Code "G0 G91 " & AxisLetter & ComMove	While Ismoving()	Wend	Code "G90"	Code "G4 P0.5"	ActMove = Question("How far did the " & AxisLetter & " Axis move? (Measured Value)")	If ActMove = 0 Then		MsgBox "Can't have a Move of Zero, Axis Calc aborted."		Exit Sub	End If		OldPPR = GetParam(Axis)	NewPPR = Abs((ComMove/ActMove) * OldPPR)	Response =  MsgBox ( AxisLetter & " Axis Will be Set to " & NewPPR & " Steps per Unit. Would you like to Accept it??", 4 , "Set Steps Per Unit") 	If Response = 6 Then   ' User chose Yes.		Call SetParam(Axis, NewPPR)		MsgBox (AxisLetter & " Axis Has Been Set")	Else   ' User chose No.		MsgBox (AxisLetter & " Axis Has NOT Been Set")	End IfEnd SubMain